# Handoff Document
Generated: 2026-01-13 22:21:49

## Summary

Implemented a new `/parallel_claudes:swarm` command for the parallel_claudes plugin. This command breaks down complex tasks into MECE (Mutually Exclusive, Collectively Exhaustive) sub-tasks and executes them in parallel waves with dependency management. Unlike other commands in the plugin that follow a deliberation-first pattern, swarm executes immediately after plan approval.

## Current Status

### Completed
- **New swarm.md command** (413 lines) - Full implementation with:
  - MECE task decomposition guidelines
  - Wave-based execution with dependency tracking
  - Real-time progress visualization (ASCII bar charts + TodoWrite)
  - Checkpoint-based progress tracking (`[CHECKPOINT: READ_FILES]`, etc.)
  - Per-task agent type configuration
  - Specialized agent auto-suggestion (e.g., code-reviewer for security tasks)
  - File conflict handling (sequential queue)
  - Failure recovery (user decides: retry/skip/abort)
  - Post-completion verification options

- **README updates**:
  - Root `README.md`: Added swarm entry, MECE explanation, `[!CAUTION]` warning, ideal workflow
  - Plugin `README.md`: Full swarm documentation, caution block, recommended 3-phase workflow

- **Documentation patterns**:
  - Added `## Execution, Not Deliberation` section (parallel to other commands' deliberation disclaimers)
  - Added `## Specialized Agent Types` section
  - Added "When NOT to use swarm" guidance with latency considerations

### In Progress
- Nothing in progress - all work committed and pushed

### Blocked/Pending
- Plugin needs Claude Code restart to load new command

## Recent Changes

### Files Created
- `plugins/parallel_claudes/commands/swarm.md` (413 lines)

### Files Modified
- `plugins/README.md` (+14 lines)
- `plugins/parallel_claudes/README.md` (+86 lines)

### Key Commit
```
8f0bad6 Add swarm command for parallel task execution with dependency management
```

## Next Steps

### To Test the Command
1. Restart Claude Code to load the new plugin configuration
2. Try: `/parallel_claudes:swarm add user authentication with routes, models, and tests`
3. Verify task graph displays correctly with agent types
4. Test the progress visualization during execution

### Potential Enhancements
1. **Wave cancellation**: No documented way to abort mid-execution (Ctrl+C behavior)
2. **Rollback automation**: Currently manual (`git checkout .`), could add `--rollback` flag
3. **Progress persistence**: Save progress state for session recovery
4. **Cost estimation**: Show estimated token usage before approval

### Open Questions
1. Should there be a `--dry-run` flag despite plan approval serving this purpose?
2. Should swarm integrate directly with `parallel_generation` output (auto-detect design consensus)?
3. How should swarm handle very large task breakdowns (>20 tasks)?

## Context & Notes

### Design Decisions (User-Confirmed)
| Decision | Choice |
|----------|--------|
| Pre-execution approval | Show task graph, get approval before executing |
| File conflicts | Sequential queue (second agent waits) |
| Upstream failures | Ask user how to proceed |
| Max concurrent agents | 7 (consistent with other commands) |
| Progress reporting | Real-time updates with ASCII bar charts |
| Post-completion | Offer role_based_review or tests |

### Key Architectural Patterns
- **Checkpoint markers**: Agents output `[CHECKPOINT: READ_FILES]`, `[CHECKPOINT: PLAN_CHANGES]`, `[CHECKPOINT: APPLY_CHANGES]` for progress tracking
- **Background execution**: Uses `run_in_background=true` with `TaskOutput` polling
- **SYNC markers**: Added `<!-- SYNC: execution-disclaimer -->` and `<!-- SYNC: token-efficiency-swarm -->` for pattern consistency

### Recommended Workflow
The ideal path for complex features:
```
/parallel_claudes:parallel_generation → /parallel_claudes:swarm → /parallel_claudes:role_based_review
```
(Deliberate → Execute → Verify)

### Gotchas
- Subagent startup overhead is ~5-15 seconds each; swarm is for larger tasks
- The `[!CAUTION]` GitHub admonition syntax may not render in all markdown viewers
- Task tool API parameters (`subagent_type`, `run_in_background`) should be verified against actual implementation
